<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Sign Up</title>
  </head>
  <body>
  <form onsubmit="return false">
    <label for="name">First Name</label>
    <br>
    <input type="text" required id="name" placeholder="First Name"/>
    <br>
    <label for="last">Last Name</label>
    <br>
    <input type="text" required id="last" placeholder="Last Name"/>
    <br>
    <label for="mail">E-Mail</label>
    <br>
    <input type="email" required id="mail" placeholder="E-Mail Adress"/>
    <br>
    <label for="Username">Username</label>
    <br>
    <input type="text" required id="Username" placeholder="Username"/>
    <br>
    <label for="Pass">Password</label>
    <br>
    <input type="password" required id="Pass" placeholder="Password"/>
    <br>
    <label for="Team">Team Name</label>
    <br>
    <input type="text" id="Team" placeholder="Team Name">
    <br>
    <label for="inp">Upload Profile Picture</label>
    <br>
    <input id="inp" type="file" accept="image/*"/>
    <br>
    <button type="submit" id="Submit">Submit</button>
    <br>
    </form>
<script src="/jquery.js"></script>
<script>
    $("#Submit").on("click", function() {
        const image = $("#inp")[0].files[0];
        const $name = $('#name');
        const $Lname = $('#last');
        const $Email = $('#mail');
        const $User = $('#Username');
        const $Pass = $('#Pass');
        const $Team = $('#Team');
        const formData = new FormData();
        formData.append("image", image);
        const name = $name.val().length === 1 ? alert("Length of your name must be at least 2 characters") : $name.val();
        const Lname = $Lname.val().length === 1 ? alert("Length of your Last name must be at least 2 characters") : $Lname.val();
        const Email = $Email.val().length === 1 ? alert("Length of your E-mail must be at least 2 characters") : $Email.val();
        const User = $User.val().length < 6 ? alert("Length of your Username must be at least 6 characters") : $User.val();
        const Pass = $Pass.val().length <= 6 ? alert("Length of your Password must be at least 6 characters") : $Pass.val();
        if (name && Lname  && Email && User && Pass) {
            $.ajax({
                type: "POST",
                url: "/TXT",
                data: JSON.stringify({
                    firstName: name,
                    lastName: Lname,
                    email: Email,
                    team: $Team.val(),
                    username: User,
                    password: Pass
                }),
                contentType: 'application/json',
                success: function(e) {
                    if (image) {
                        $.ajax({
                            url: "/upload",
                            type: "POST",
                            data: formData,
                            contentType: false,
                            processData: false,
                            success: function (e) {
                                console.log("Done haha");
                                window.location = '/';
                            },
                            error: function (e) {
                                console.log("Error while sending Images");
                            }
                        });
                    } else {
                      window.location = '/';
                    }
                },
                error: function(e) {
                    alert("Try another username user already exists");
                }
            });
        } else {
            alert("Enter proper data!");
        }
    });
</script>
</body>
</html>
